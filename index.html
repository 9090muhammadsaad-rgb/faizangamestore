<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Faizan Store</title>
<style>
body {
  margin: 0;
  font-family: 'Poppins', sans-serif;
  background: #0f0f0f;
  color: #fff;
}
header {
  background: url('footer.jpg') center/cover no-repeat;
  text-align: center;
  padding: 50px 10px;
  font-size: 2.5em;
  font-weight: bold;
  color: #fff;
  text-shadow: 2px 2px 10px #000;
}
header button {
  margin-top: 15px;
  background: #00aaff;
  border: none;
  padding: 10px 20px;
  border-radius: 6px;
  color: white;
  cursor: pointer;
  font-size: 1em;
}
header button:hover {
  background: #00c3ff;
}
.search-bar {
  display: flex;
  justify-content: center;
  margin: 25px;
}
.search-bar input {
  width: 70%;
  max-width: 500px;
  padding: 12px;
  border-radius: 10px;
  border: none;
  outline: none;
  font-size: 1em;
  background: #1a1a1a;
  color: white;
  box-shadow: 0 0 6px #000;
}
#games {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 25px;
  padding: 20px;
}
.game {
  background: #1a1a1a;
  border-radius: 14px;
  box-shadow: 0 0 10px #000;
  padding: 15px;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.game:hover {
  transform: scale(1.03);
  box-shadow: 0 0 15px #0077ff;
}
.game img {
  width: 100%;
  border-radius: 10px;
  object-fit: cover;
}
.download-btn {
  background: #0077ff;
  border: none;
  padding: 10px 15px;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  margin-top: 8px;
  font-size: 0.9em;
}
.download-btn:hover {
  background: #00aaff;
}
.retry-btn {
  background: #0044ff;
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  color: white;
  cursor: pointer;
  margin-top: 6px;
  display: none;
  font-size: 0.85em;
}
footer {
  text-align: center;
  padding: 20px;
  background: #111;
  font-size: 0.95em;
}
footer a {
  color: #00aaff;
  text-decoration: none;
}
footer a:hover {
  text-decoration: underline;
}
</style>
</head>
<body>

<header>
  Faizan Store
  <div>
    <button onclick="window.location='mailto:muhmmadsaad226@gmail.com'">Help Us</button>
  </div>
</header>

<div class="search-bar">
  <input type="text" id="searchInput" placeholder="Search games...">
</div>

<div id="games">Loading games...</div>

<footer>
  <p onclick="alert('(c) Saad')" style="cursor:pointer;">(c) Saad</p>
</footer>

<script>
// ðŸ§© GitHub info
const username = "9090muhammadsaad-rgb";
const repo = "faizangamestore";

const gamesContainer = document.getElementById('games');
const searchInput = document.getElementById('searchInput');

async function fetchGames() {
  try {
    const res = await fetch(`https://api.github.com/repos/${username}/${repo}/contents/`);
    const data = await res.json();
    const gameDirs = data.filter(item => item.type === "dir" && item.name.endsWith("__(game)"));
    if (gameDirs.length === 0) {
      gamesContainer.textContent = "No Games Uploaded Yet.";
      return;
    }

    gamesContainer.textContent = "";
    for (const dir of gameDirs) {
      await loadGame(dir.name);
    }
  } catch (err) {
    gamesContainer.textContent = "Error loading games.";
    console.error(err);
  }
}

async function loadTextFile(path) {
  try {
    const res = await fetch(`https://raw.githubusercontent.com/${username}/${repo}/main/${path}`);
    return res.ok ? await res.text() : "N/A";
  } catch {
    return "N/A";
  }
}

async function loadGame(folder) {
  const appInfo = `${folder}/app_info`;
  const [iconJpg, iconPng] = [
    `https://raw.githubusercontent.com/${username}/${repo}/main/${folder}/icon.jpg`,
    `https://raw.githubusercontent.com/${username}/${repo}/main/${folder}/icon.png`
  ];
  let icon = iconJpg;
  if (!(await fetch(iconJpg)).ok) icon = iconPng;

  const name = await loadTextFile(`${appInfo}/app_name.txt`);
  const pkg = await loadTextFile(`${appInfo}/pkg.txt`);
  const date = await loadTextFile(`${appInfo}/date.txt`);
  const size = await loadTextFile(`${appInfo}/size.txt`);
  const desc = await loadTextFile(`${appInfo}/description.txt`);
  const work = await loadTextFile(`${appInfo}/work.txt`);
  const link = await loadTextFile(`${folder}/description.txt`);

  const gameEl = document.createElement("div");
  gameEl.className = "game";
  gameEl.innerHTML = `
    <img loading="lazy" src="${icon}" alt="${name}">
    <h3>${name}</h3>
    <p><b>Package:</b> ${pkg}</p>
    <p><b>Size:</b> ${size}</p>
    <p><b>Date:</b> ${date}</p>
    <p><b>Description:</b> ${desc}</p>
    <p><b>Info:</b> ${work}</p>
    <button class="download-btn">Download</button>
    <button class="retry-btn">Retry</button>
  `;

  const downloadBtn = gameEl.querySelector(".download-btn");
  const retryBtn = gameEl.querySelector(".retry-btn");

  downloadBtn.onclick = () => {
    if (link === "N/A") {
      alert("Download link not available");
      return;
    }
    window.open(link.trim(), "_blank");
    retryBtn.style.display = "inline-block";
  };

  retryBtn.onclick = () => {
    window.open(link.trim(), "_blank");
  };

  gamesContainer.appendChild(gameEl);
}

searchInput.addEventListener("input", () => {
  const query = searchInput.value.toLowerCase();
  const games = document.querySelectorAll(".game");
  games.forEach(g => {
    const text = g.innerText.toLowerCase();
    g.style.display = text.includes(query) ? "block" : "none";
  });
});

fetchGames();
</script>
</body>
</html>
